# ADR-001: Мікросервісна архітектура

## Status

Accepted

## Date

2024-01-15

## Context

При проектуванні Shop Platform потрібно було вирішити, яку архітектуру використовувати: монолітну чи мікросервісну.

**Вимоги:**
- Масштабованість під високе навантаження (Black Friday, розпродажі)
- Незалежний деплой різних компонентів
- Можливість використовувати різні технології для різних задач
- Ізоляція failures - проблема в одному компоненті не має валити всю систему
- Підтримка команди з 10+ розробників

**Альтернативи:**

1. **Моноліт** - один додаток, простіший в розробці на початку
2. **Мікросервіси** - окремі сервіси для кожного домену
3. **Modular Monolith** - моноліт з чіткими модулями, можливість подальшого розділення

## Decision

Обрано **мікросервісну архітектуру** з наступним розподілом:

### Core Services

| Сервіс | Відповідальність |
|--------|------------------|
| Core API | Товари, категорії, пошук, каталог |
| OMS | Замовлення, оплата, доставка |
| CRM | Клієнти, сегментація, лояльність |
| Notification | Email, SMS, Push сповіщення |
| Telegram Bot | Telegram інтеграція |

### Frontend Services

| Сервіс | Відповідальність |
|--------|------------------|
| Storefront | Публічний магазин (SSR) |
| Admin | Адмін панель (SPA) |

### Комунікація

- **Синхронна**: REST API для запитів, що потребують негайної відповіді
- **Асинхронна**: RabbitMQ для подій та фонових задач

### Service Boundaries

Кожен сервіс:
- Має власну базу даних (Database per Service)
- Незалежно деплоїться
- Має чітко визначений API
- Володіє своїми даними

## Consequences

### Позитивні

- ✅ **Масштабованість**: кожен сервіс масштабується незалежно
- ✅ **Технологічна гнучкість**: можливість використовувати найкращий інструмент для задачі
- ✅ **Ізоляція failures**: падіння OMS не впливає на каталог
- ✅ **Незалежний деплой**: швидші та безпечніші релізи
- ✅ **Ownership**: чіткі границі відповідальності команд

### Негативні

- ❌ **Складність**: distributed systems складніші в розробці та debugging
- ❌ **Operational overhead**: більше сервісів = більше інфраструктури
- ❌ **Network latency**: міжсервісні виклики повільніші за in-process
- ❌ **Data consistency**: eventual consistency замість ACID
- ❌ **Testing**: складніше інтеграційне тестування

### Mitigation

- Використання Kubernetes для спрощення операцій
- Distributed tracing (Jaeger) для debugging
- Circuit breakers для fault tolerance
- Saga pattern для distributed transactions

## Related Decisions

- [ADR-006: Event-driven архітектура](./ADR-006-event-driven.md)
- [ADR-007: Kubernetes для оркестрації](./ADR-007-kubernetes.md)
